<!DOCTYPE html>
<html lang="sq">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shqip365 - Ndeshjet</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header>
    <h1>Shqip365</h1>
    <nav>
      <button class="active" onclick="showCategory('live')">Live</button>
      <button onclick="showCategory('upcoming')">S√´ Shpejti</button>
      <button onclick="showCategory('finished')">P√´rfunduar</button>
      <button onclick="showCategory('all')">T√´ Gjitha</button>
    </nav>
  </header>

  <main id="matches-container">
    <div class="loading">‚öΩ Duke ngarkuar ndeshjet...</div>
  </main>

  <footer>
    <p>¬© 2025 Shqip365 ‚Äî Kuq e Zi ‚ö´üî¥</p>
  </footer>

  <script>
    const container = document.getElementById("matches-container");

    async function loadMatches(type = "live") {
      container.innerHTML = '<div class="loading">Duke ngarkuar...</div>';
      const today = new Date().toISOString().split("T")[0];
      const tomorrow = new Date(Date.now() + 86400000).toISOString().split("T")[0];

      let endpoint = "";
      if (type === "live") endpoint = "https://v3.football.api-sports.io/fixtures?live=all";
      else if (type === "upcoming") endpoint = `https://v3.football.api-sports.io/fixtures?date=${tomorrow}`;
      else if (type === "finished") endpoint = `https://v3.football.api-sports.io/fixtures?date=${today}&status=FT`;
      else endpoint = `https://v3.football.api-sports.io/fixtures?date=${today}`;

      try {
        const response = await fetch(endpoint, {
          method: "GET",
          headers: {
            "x-apisports-key": "VENDOS_API_KEY_T√ãND_K√ãTU"
          }
        });
        const data = await response.json();

        if (!data.response || data.response.length === 0) {
          container.innerHTML = '<div class="no-matches">Nuk ka ndeshje p√´r momentin.</div>';
          return;
        }

        container.innerHTML = "";
        let currentDate = "";

        data.response.forEach(match => {
          const date = new Date(match.fixture.date).toLocaleDateString("sq-AL", {
            day: "numeric",
            month: "long",
            year: "numeric",
          });
          const time = new Date(match.fixture.date).toLocaleTimeString("sq-AL", {
            hour: "2-digit",
            minute: "2-digit",
          });
          const league = match.league.name;
          const home = match.teams.home;
          const away = match.teams.away;
          const scoreHome = match.goals.home ?? "-";
          const scoreAway = match.goals.away ?? "-";

          if (date !== currentDate) {
            currentDate = date;
            container.innerHTML += `<h2 class="match-date">üìÖ ${date}</h2>`;
          }

          container.innerHTML += `
            <div class="match-card">
              <div class="match-header">
                <img src="${match.league.logo}" alt="league" class="league-logo"/>
                <span class="league-name">${league}</span>
                <span class="match-time">${time}</span>
              </div>
              <div class="teams">
                <div class="team">
                  <img src="${home.logo}" alt="${home.name}">
                  <span>${home.name}</span>
                </div>
                <div class="score">${scoreHome} - ${scoreAway}</div>
                <div class="team">
                  <img src="${away.logo}" alt="${away.name}">
                  <span>${away.name}</span>
                </div>
              </div>
            </div>
          `;
        });
      } catch (err) {
        container.innerHTML = '<div class="error">‚ùå Nuk mund t√´ ngarkohen ndeshjet.</div>';
      }
    }

    function showCategory(type) {
      document.querySelectorAll("nav button").forEach(btn => btn.classList.remove("active"));
      event.target.classList.add("active");
      loadMatches(type);
    }

    // auto-refresh √ßdo 60 sekonda p√´r LIVE
    setInterval(() => {
      if (document.querySelector("nav button.active").textContent === "Live") {
        loadMatches("live");
      }
    }, 60000);

    loadMatches();
  </script>
</body>
</html>
